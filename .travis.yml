language: node_js
node_js:
    - "5.3.0"
before_script:
    - npm install -g gulp
script:
    - npm install
    - npm run build
after_script:
    - ls build
    - git clone https://castlerek:$token@github.com/castlerek/webgl.native.experiments.git --branch=gh-pages gh-pages
    - cd gh-pages
    - git branch
    - echo -e "Directory before-content\n$(ls -la)"
    - rm -rf * && rm -f .travis.yml && rm -f .appveyor.yml
    - export revision=$TRAVIS_COMMIT.$TRAVIS_BUILD_NUMBER
    - echo $revision
    - mkdir $revision
    - cd $revision
    - cp -R ../../build build
    - cp -R ../../deployment/* .
    - git add --all
    - git status
    - echo Current path $(pwd)
    - echo -e "Directory after-content\n$(ls -la)"
    - git config --global user.name "Travis CI"
    - git commit -m "Update for $TRAVIS_COMMIT"
    - git push origin gh-pages